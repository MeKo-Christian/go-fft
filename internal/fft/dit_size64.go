package fft

//nolint:funlen
func forwardDIT64Complex64(dst, src, twiddle, scratch []complex64, bitrev []int) bool {
	const n = 64

	if len(dst) < n || len(twiddle) < n || len(scratch) < n || len(bitrev) < n || len(src) < n {
		return false
	}

	work := dst
	workIsDst := true

	if sameSlice(dst, src) {
		work = scratch
		workIsDst = false
	}

	br := bitrev[:n]
	s := src[:n]
	w1, w2, w3, w4, w5, w6, w7, w8 := twiddle[1], twiddle[2], twiddle[3], twiddle[4], twiddle[5], twiddle[6], twiddle[7], twiddle[8]
	w9, w10, w11, w12, w13, w14, w15, w16 := twiddle[9], twiddle[10], twiddle[11], twiddle[12], twiddle[13], twiddle[14], twiddle[15], twiddle[16]
	w17, w18, w19, w20, w21, w22, w23, w24 := twiddle[17], twiddle[18], twiddle[19], twiddle[20], twiddle[21], twiddle[22], twiddle[23], twiddle[24]
	w25, w26, w27, w28, w29, w30, w31 := twiddle[25], twiddle[26], twiddle[27], twiddle[28], twiddle[29], twiddle[30], twiddle[31]

	// Stage 1 (size 2) - 32 butterflies
	x0 := s[br[0]]
	x1 := s[br[1]]
	a0, a1 := x0+x1, x0-x1

	x0 = s[br[2]]
	x1 = s[br[3]]
	a2, a3 := x0+x1, x0-x1

	x0 = s[br[4]]
	x1 = s[br[5]]
	a4, a5 := x0+x1, x0-x1

	x0 = s[br[6]]
	x1 = s[br[7]]
	a6, a7 := x0+x1, x0-x1

	x0 = s[br[8]]
	x1 = s[br[9]]
	a8, a9 := x0+x1, x0-x1

	x0 = s[br[10]]
	x1 = s[br[11]]
	a10, a11 := x0+x1, x0-x1

	x0 = s[br[12]]
	x1 = s[br[13]]
	a12, a13 := x0+x1, x0-x1

	x0 = s[br[14]]
	x1 = s[br[15]]
	a14, a15 := x0+x1, x0-x1

	x0 = s[br[16]]
	x1 = s[br[17]]
	a16, a17 := x0+x1, x0-x1

	x0 = s[br[18]]
	x1 = s[br[19]]
	a18, a19 := x0+x1, x0-x1

	x0 = s[br[20]]
	x1 = s[br[21]]
	a20, a21 := x0+x1, x0-x1

	x0 = s[br[22]]
	x1 = s[br[23]]
	a22, a23 := x0+x1, x0-x1

	x0 = s[br[24]]
	x1 = s[br[25]]
	a24, a25 := x0+x1, x0-x1

	x0 = s[br[26]]
	x1 = s[br[27]]
	a26, a27 := x0+x1, x0-x1

	x0 = s[br[28]]
	x1 = s[br[29]]
	a28, a29 := x0+x1, x0-x1

	x0 = s[br[30]]
	x1 = s[br[31]]
	a30, a31 := x0+x1, x0-x1

	x0 = s[br[32]]
	x1 = s[br[33]]
	a32, a33 := x0+x1, x0-x1

	x0 = s[br[34]]
	x1 = s[br[35]]
	a34, a35 := x0+x1, x0-x1

	x0 = s[br[36]]
	x1 = s[br[37]]
	a36, a37 := x0+x1, x0-x1

	x0 = s[br[38]]
	x1 = s[br[39]]
	a38, a39 := x0+x1, x0-x1

	x0 = s[br[40]]
	x1 = s[br[41]]
	a40, a41 := x0+x1, x0-x1

	x0 = s[br[42]]
	x1 = s[br[43]]
	a42, a43 := x0+x1, x0-x1

	x0 = s[br[44]]
	x1 = s[br[45]]
	a44, a45 := x0+x1, x0-x1

	x0 = s[br[46]]
	x1 = s[br[47]]
	a46, a47 := x0+x1, x0-x1

	x0 = s[br[48]]
	x1 = s[br[49]]
	a48, a49 := x0+x1, x0-x1

	x0 = s[br[50]]
	x1 = s[br[51]]
	a50, a51 := x0+x1, x0-x1

	x0 = s[br[52]]
	x1 = s[br[53]]
	a52, a53 := x0+x1, x0-x1

	x0 = s[br[54]]
	x1 = s[br[55]]
	a54, a55 := x0+x1, x0-x1

	x0 = s[br[56]]
	x1 = s[br[57]]
	a56, a57 := x0+x1, x0-x1

	x0 = s[br[58]]
	x1 = s[br[59]]
	a58, a59 := x0+x1, x0-x1

	x0 = s[br[60]]
	x1 = s[br[61]]
	a60, a61 := x0+x1, x0-x1

	x0 = s[br[62]]
	x1 = s[br[63]]
	a62, a63 := x0+x1, x0-x1

	// Stage 2 (size 4)
	b0, b2 := a0+a2, a0-a2
	t := w16 * a3
	b1, b3 := a1+t, a1-t
	b4, b6 := a4+a6, a4-a6
	t = w16 * a7
	b5, b7 := a5+t, a5-t
	b8, b10 := a8+a10, a8-a10
	t = w16 * a11
	b9, b11 := a9+t, a9-t
	b12, b14 := a12+a14, a12-a14
	t = w16 * a15
	b13, b15 := a13+t, a13-t
	b16, b18 := a16+a18, a16-a18
	t = w16 * a19
	b17, b19 := a17+t, a17-t
	b20, b22 := a20+a22, a20-a22
	t = w16 * a23
	b21, b23 := a21+t, a21-t
	b24, b26 := a24+a26, a24-a26
	t = w16 * a27
	b25, b27 := a25+t, a25-t
	b28, b30 := a28+a30, a28-a30
	t = w16 * a31
	b29, b31 := a29+t, a29-t
	b32, b34 := a32+a34, a32-a34
	t = w16 * a35
	b33, b35 := a33+t, a33-t
	b36, b38 := a36+a38, a36-a38
	t = w16 * a39
	b37, b39 := a37+t, a37-t
	b40, b42 := a40+a42, a40-a42
	t = w16 * a43
	b41, b43 := a41+t, a41-t
	b44, b46 := a44+a46, a44-a46
	t = w16 * a47
	b45, b47 := a45+t, a45-t
	b48, b50 := a48+a50, a48-a50
	t = w16 * a51
	b49, b51 := a49+t, a49-t
	b52, b54 := a52+a54, a52-a54
	t = w16 * a55
	b53, b55 := a53+t, a53-t
	b56, b58 := a56+a58, a56-a58
	t = w16 * a59
	b57, b59 := a57+t, a57-t
	b60, b62 := a60+a62, a60-a62
	t = w16 * a63
	b61, b63 := a61+t, a61-t

	// Stage 3 (size 8)
	c0, c4 := b0+b4, b0-b4
	t = w8 * b5
	c1, c5 := b1+t, b1-t
	t = w16 * b6
	c2, c6 := b2+t, b2-t
	t = w24 * b7
	c3, c7 := b3+t, b3-t
	c8, c12 := b8+b12, b8-b12
	t = w8 * b13
	c9, c13 := b9+t, b9-t
	t = w16 * b14
	c10, c14 := b10+t, b10-t
	t = w24 * b15
	c11, c15 := b11+t, b11-t
	c16, c20 := b16+b20, b16-b20
	t = w8 * b21
	c17, c21 := b17+t, b17-t
	t = w16 * b22
	c18, c22 := b18+t, b18-t
	t = w24 * b23
	c19, c23 := b19+t, b19-t
	c24, c28 := b24+b28, b24-b28
	t = w8 * b29
	c25, c29 := b25+t, b25-t
	t = w16 * b30
	c26, c30 := b26+t, b26-t
	t = w24 * b31
	c27, c31 := b27+t, b27-t
	c32, c36 := b32+b36, b32-b36
	t = w8 * b37
	c33, c37 := b33+t, b33-t
	t = w16 * b38
	c34, c38 := b34+t, b34-t
	t = w24 * b39
	c35, c39 := b35+t, b35-t
	c40, c44 := b40+b44, b40-b44
	t = w8 * b45
	c41, c45 := b41+t, b41-t
	t = w16 * b46
	c42, c46 := b42+t, b42-t
	t = w24 * b47
	c43, c47 := b43+t, b43-t
	c48, c52 := b48+b52, b48-b52
	t = w8 * b53
	c49, c53 := b49+t, b49-t
	t = w16 * b54
	c50, c54 := b50+t, b50-t
	t = w24 * b55
	c51, c55 := b51+t, b51-t
	c56, c60 := b56+b60, b56-b60
	t = w8 * b61
	c57, c61 := b57+t, b57-t
	t = w16 * b62
	c58, c62 := b58+t, b58-t
	t = w24 * b63
	c59, c63 := b59+t, b59-t

	// Stage 4 (size 16)
	d0, d8 := c0+c8, c0-c8
	t = w4 * c9
	d1, d9 := c1+t, c1-t
	t = w8 * c10
	d2, d10 := c2+t, c2-t
	t = w12 * c11
	d3, d11 := c3+t, c3-t
	t = w16 * c12
	d4, d12 := c4+t, c4-t
	t = w20 * c13
	d5, d13 := c5+t, c5-t
	t = w24 * c14
	d6, d14 := c6+t, c6-t
	t = w28 * c15
	d7, d15 := c7+t, c7-t
	d16, d24 := c16+c24, c16-c24
	t = w4 * c25
	d17, d25 := c17+t, c17-t
	t = w8 * c26
	d18, d26 := c18+t, c18-t
	t = w12 * c27
	d19, d27 := c19+t, c19-t
	t = w16 * c28
	d20, d28 := c20+t, c20-t
	t = w20 * c29
	d21, d29 := c21+t, c21-t
	t = w24 * c30
	d22, d30 := c22+t, c22-t
	t = w28 * c31
	d23, d31 := c23+t, c23-t
	d32, d40 := c32+c40, c32-c40
	t = w4 * c41
	d33, d41 := c33+t, c33-t
	t = w8 * c42
	d34, d42 := c34+t, c34-t
	t = w12 * c43
	d35, d43 := c35+t, c35-t
	t = w16 * c44
	d36, d44 := c36+t, c36-t
	t = w20 * c45
	d37, d45 := c37+t, c37-t
	t = w24 * c46
	d38, d46 := c38+t, c38-t
	t = w28 * c47
	d39, d47 := c39+t, c39-t
	d48, d56 := c48+c56, c48-c56
	t = w4 * c57
	d49, d57 := c49+t, c49-t
	t = w8 * c58
	d50, d58 := c50+t, c50-t
	t = w12 * c59
	d51, d59 := c51+t, c51-t
	t = w16 * c60
	d52, d60 := c52+t, c52-t
	t = w20 * c61
	d53, d61 := c53+t, c53-t
	t = w24 * c62
	d54, d62 := c54+t, c54-t
	t = w28 * c63
	d55, d63 := c55+t, c55-t

	// Stage 5 (size 32)
	e0, e16 := d0+d16, d0-d16
	t = w2 * d17
	e1, e17 := d1+t, d1-t
	t = w4 * d18
	e2, e18 := d2+t, d2-t
	t = w6 * d19
	e3, e19 := d3+t, d3-t
	t = w8 * d20
	e4, e20 := d4+t, d4-t
	t = w10 * d21
	e5, e21 := d5+t, d5-t
	t = w12 * d22
	e6, e22 := d6+t, d6-t
	t = w14 * d23
	e7, e23 := d7+t, d7-t
	t = w16 * d24
	e8, e24 := d8+t, d8-t
	t = w18 * d25
	e9, e25 := d9+t, d9-t
	t = w20 * d26
	e10, e26 := d10+t, d10-t
	t = w22 * d27
	e11, e27 := d11+t, d11-t
	t = w24 * d28
	e12, e28 := d12+t, d12-t
	t = w26 * d29
	e13, e29 := d13+t, d13-t
	t = w28 * d30
	e14, e30 := d14+t, d14-t
	t = w30 * d31
	e15, e31 := d15+t, d15-t
	e32, e48 := d32+d48, d32-d48
	t = w2 * d49
	e33, e49 := d33+t, d33-t
	t = w4 * d50
	e34, e50 := d34+t, d34-t
	t = w6 * d51
	e35, e51 := d35+t, d35-t
	t = w8 * d52
	e36, e52 := d36+t, d36-t
	t = w10 * d53
	e37, e53 := d37+t, d37-t
	t = w12 * d54
	e38, e54 := d38+t, d38-t
	t = w14 * d55
	e39, e55 := d39+t, d39-t
	t = w16 * d56
	e40, e56 := d40+t, d40-t
	t = w18 * d57
	e41, e57 := d41+t, d41-t
	t = w20 * d58
	e42, e58 := d42+t, d42-t
	t = w22 * d59
	e43, e59 := d43+t, d43-t
	t = w24 * d60
	e44, e60 := d44+t, d44-t
	t = w26 * d61
	e45, e61 := d45+t, d45-t
	t = w28 * d62
	e46, e62 := d46+t, d46-t
	t = w30 * d63
	e47, e63 := d47+t, d47-t

	// Stage 6 (size 64)
	work = work[:n]
	work[0], work[32] = e0+e32, e0-e32
	t = w1 * e33
	work[1], work[33] = e1+t, e1-t
	t = w2 * e34
	work[2], work[34] = e2+t, e2-t
	t = w3 * e35
	work[3], work[35] = e3+t, e3-t
	t = w4 * e36
	work[4], work[36] = e4+t, e4-t
	t = w5 * e37
	work[5], work[37] = e5+t, e5-t
	t = w6 * e38
	work[6], work[38] = e6+t, e6-t
	t = w7 * e39
	work[7], work[39] = e7+t, e7-t
	t = w8 * e40
	work[8], work[40] = e8+t, e8-t
	t = w9 * e41
	work[9], work[41] = e9+t, e9-t
	t = w10 * e42
	work[10], work[42] = e10+t, e10-t
	t = w11 * e43
	work[11], work[43] = e11+t, e11-t
	t = w12 * e44
	work[12], work[44] = e12+t, e12-t
	t = w13 * e45
	work[13], work[45] = e13+t, e13-t
	t = w14 * e46
	work[14], work[46] = e14+t, e14-t
	t = w15 * e47
	work[15], work[47] = e15+t, e15-t
	t = w16 * e48
	work[16], work[48] = e16+t, e16-t
	t = w17 * e49
	work[17], work[49] = e17+t, e17-t
	t = w18 * e50
	work[18], work[50] = e18+t, e18-t
	t = w19 * e51
	work[19], work[51] = e19+t, e19-t
	t = w20 * e52
	work[20], work[52] = e20+t, e20-t
	t = w21 * e53
	work[21], work[53] = e21+t, e21-t
	t = w22 * e54
	work[22], work[54] = e22+t, e22-t
	t = w23 * e55
	work[23], work[55] = e23+t, e23-t
	t = w24 * e56
	work[24], work[56] = e24+t, e24-t
	t = w25 * e57
	work[25], work[57] = e25+t, e25-t
	t = w26 * e58
	work[26], work[58] = e26+t, e26-t
	t = w27 * e59
	work[27], work[59] = e27+t, e27-t
	t = w28 * e60
	work[28], work[60] = e28+t, e28-t
	t = w29 * e61
	work[29], work[61] = e29+t, e29-t
	t = w30 * e62
	work[30], work[62] = e30+t, e30-t
	t = w31 * e63
	work[31], work[63] = e31+t, e31-t

	if !workIsDst {
		copy(dst, work)
	}

	return true
}

//nolint:funlen
func inverseDIT64Complex64(dst, src, twiddle, scratch []complex64, bitrev []int) bool {
	const n = 64

	if len(dst) < n || len(twiddle) < n || len(scratch) < n || len(bitrev) < n || len(src) < n {
		return false
	}

	work := dst
	workIsDst := true

	if sameSlice(dst, src) {
		work = scratch
		workIsDst = false
	}

	br := bitrev[:n]
	s := src[:n]

	// Load all 64 elements with bit-reversal
	x0 := s[br[0]]
	x1 := s[br[1]]
	x2 := s[br[2]]
	x3 := s[br[3]]
	x4 := s[br[4]]
	x5 := s[br[5]]
	x6 := s[br[6]]
	x7 := s[br[7]]
	x8 := s[br[8]]
	x9 := s[br[9]]
	x10 := s[br[10]]
	x11 := s[br[11]]
	x12 := s[br[12]]
	x13 := s[br[13]]
	x14 := s[br[14]]
	x15 := s[br[15]]
	x16 := s[br[16]]
	x17 := s[br[17]]
	x18 := s[br[18]]
	x19 := s[br[19]]
	x20 := s[br[20]]
	x21 := s[br[21]]
	x22 := s[br[22]]
	x23 := s[br[23]]
	x24 := s[br[24]]
	x25 := s[br[25]]
	x26 := s[br[26]]
	x27 := s[br[27]]
	x28 := s[br[28]]
	x29 := s[br[29]]
	x30 := s[br[30]]
	x31 := s[br[31]]
	x32 := s[br[32]]
	x33 := s[br[33]]
	x34 := s[br[34]]
	x35 := s[br[35]]
	x36 := s[br[36]]
	x37 := s[br[37]]
	x38 := s[br[38]]
	x39 := s[br[39]]
	x40 := s[br[40]]
	x41 := s[br[41]]
	x42 := s[br[42]]
	x43 := s[br[43]]
	x44 := s[br[44]]
	x45 := s[br[45]]
	x46 := s[br[46]]
	x47 := s[br[47]]
	x48 := s[br[48]]
	x49 := s[br[49]]
	x50 := s[br[50]]
	x51 := s[br[51]]
	x52 := s[br[52]]
	x53 := s[br[53]]
	x54 := s[br[54]]
	x55 := s[br[55]]
	x56 := s[br[56]]
	x57 := s[br[57]]
	x58 := s[br[58]]
	x59 := s[br[59]]
	x60 := s[br[60]]
	x61 := s[br[61]]
	x62 := s[br[62]]
	x63 := s[br[63]]

	// Stage 1 (size 2) - 32 butterflies
	a0, a1 := x0+x1, x0-x1
	a2, a3 := x2+x3, x2-x3
	a4, a5 := x4+x5, x4-x5
	a6, a7 := x6+x7, x6-x7
	a8, a9 := x8+x9, x8-x9
	a10, a11 := x10+x11, x10-x11
	a12, a13 := x12+x13, x12-x13
	a14, a15 := x14+x15, x14-x15
	a16, a17 := x16+x17, x16-x17
	a18, a19 := x18+x19, x18-x19
	a20, a21 := x20+x21, x20-x21
	a22, a23 := x22+x23, x22-x23
	a24, a25 := x24+x25, x24-x25
	a26, a27 := x26+x27, x26-x27
	a28, a29 := x28+x29, x28-x29
	a30, a31 := x30+x31, x30-x31
	a32, a33 := x32+x33, x32-x33
	a34, a35 := x34+x35, x34-x35
	a36, a37 := x36+x37, x36-x37
	a38, a39 := x38+x39, x38-x39
	a40, a41 := x40+x41, x40-x41
	a42, a43 := x42+x43, x42-x43
	a44, a45 := x44+x45, x44-x45
	a46, a47 := x46+x47, x46-x47
	a48, a49 := x48+x49, x48-x49
	a50, a51 := x50+x51, x50-x51
	a52, a53 := x52+x53, x52-x53
	a54, a55 := x54+x55, x54-x55
	a56, a57 := x56+x57, x56-x57
	a58, a59 := x58+x59, x58-x59
	a60, a61 := x60+x61, x60-x61
	a62, a63 := x62+x63, x62-x63

	// Stage 2 (size 4) - conjugate twiddle[16]
	tw16 := twiddle[16]
	w16 := complex(real(tw16), -imag(tw16))
	b0, b2 := a0+a2, a0-a2
	t1 := w16 * a3
	b1, b3 := a1+t1, a1-t1
	b4, b6 := a4+a6, a4-a6
	t5 := w16 * a7
	b5, b7 := a5+t5, a5-t5
	b8, b10 := a8+a10, a8-a10
	t9 := w16 * a11
	b9, b11 := a9+t9, a9-t9
	b12, b14 := a12+a14, a12-a14
	t13 := w16 * a15
	b13, b15 := a13+t13, a13-t13
	b16, b18 := a16+a18, a16-a18
	t17 := w16 * a19
	b17, b19 := a17+t17, a17-t17
	b20, b22 := a20+a22, a20-a22
	t21 := w16 * a23
	b21, b23 := a21+t21, a21-t21
	b24, b26 := a24+a26, a24-a26
	t25 := w16 * a27
	b25, b27 := a25+t25, a25-t25
	b28, b30 := a28+a30, a28-a30
	t29 := w16 * a31
	b29, b31 := a29+t29, a29-t29
	b32, b34 := a32+a34, a32-a34
	t33 := w16 * a35
	b33, b35 := a33+t33, a33-t33
	b36, b38 := a36+a38, a36-a38
	t37 := w16 * a39
	b37, b39 := a37+t37, a37-t37
	b40, b42 := a40+a42, a40-a42
	t41 := w16 * a43
	b41, b43 := a41+t41, a41-t41
	b44, b46 := a44+a46, a44-a46
	t45 := w16 * a47
	b45, b47 := a45+t45, a45-t45
	b48, b50 := a48+a50, a48-a50
	t49 := w16 * a51
	b49, b51 := a49+t49, a49-t49
	b52, b54 := a52+a54, a52-a54
	t53 := w16 * a55
	b53, b55 := a53+t53, a53-t53
	b56, b58 := a56+a58, a56-a58
	t57 := w16 * a59
	b57, b59 := a57+t57, a57-t57
	b60, b62 := a60+a62, a60-a62
	t61 := w16 * a63
	b61, b63 := a61+t61, a61-t61

	// Stage 3 (size 8) - conjugate twiddles
	tw8 := twiddle[8]
	tw24 := twiddle[24]
	w8 := complex(real(tw8), -imag(tw8))
	w24 := complex(real(tw24), -imag(tw24))
	c0, c4 := b0+b4, b0-b4
	t1 = w8 * b5
	c1, c5 := b1+t1, b1-t1
	t2 := w16 * b6
	c2, c6 := b2+t2, b2-t2
	t3 := w24 * b7
	c3, c7 := b3+t3, b3-t3
	c8, c12 := b8+b12, b8-b12
	t9 = w8 * b13
	c9, c13 := b9+t9, b9-t9
	t10 := w16 * b14
	c10, c14 := b10+t10, b10-t10
	t11 := w24 * b15
	c11, c15 := b11+t11, b11-t11
	c16, c20 := b16+b20, b16-b20
	t17 = w8 * b21
	c17, c21 := b17+t17, b17-t17
	t18 := w16 * b22
	c18, c22 := b18+t18, b18-t18
	t19 := w24 * b23
	c19, c23 := b19+t19, b19-t19
	c24, c28 := b24+b28, b24-b28
	t25 = w8 * b29
	c25, c29 := b25+t25, b25-t25
	t26 := w16 * b30
	c26, c30 := b26+t26, b26-t26
	t27 := w24 * b31
	c27, c31 := b27+t27, b27-t27
	c32, c36 := b32+b36, b32-b36
	t33 = w8 * b37
	c33, c37 := b33+t33, b33-t33
	t34 := w16 * b38
	c34, c38 := b34+t34, b34-t34
	t35 := w24 * b39
	c35, c39 := b35+t35, b35-t35
	c40, c44 := b40+b44, b40-b44
	t41 = w8 * b45
	c41, c45 := b41+t41, b41-t41
	t42 := w16 * b46
	c42, c46 := b42+t42, b42-t42
	t43 := w24 * b47
	c43, c47 := b43+t43, b43-t43
	c48, c52 := b48+b52, b48-b52
	t49 = w8 * b53
	c49, c53 := b49+t49, b49-t49
	t50 := w16 * b54
	c50, c54 := b50+t50, b50-t50
	t51 := w24 * b55
	c51, c55 := b51+t51, b51-t51
	c56, c60 := b56+b60, b56-b60
	t57 = w8 * b61
	c57, c61 := b57+t57, b57-t57
	t58 := w16 * b62
	c58, c62 := b58+t58, b58-t58
	t59 := w24 * b63
	c59, c63 := b59+t59, b59-t59

	// Stage 4 (size 16) - conjugate twiddles
	tw4 := twiddle[4]
	tw12 := twiddle[12]
	tw20 := twiddle[20]
	tw28 := twiddle[28]
	w4 := complex(real(tw4), -imag(tw4))
	w12 := complex(real(tw12), -imag(tw12))
	w20 := complex(real(tw20), -imag(tw20))
	w28 := complex(real(tw28), -imag(tw28))
	d0, d8 := c0+c8, c0-c8
	t1 = w4 * c9
	d1, d9 := c1+t1, c1-t1
	t2 = w8 * c10
	d2, d10 := c2+t2, c2-t2
	t3 = w12 * c11
	d3, d11 := c3+t3, c3-t3
	t4 := w16 * c12
	d4, d12 := c4+t4, c4-t4
	t5 = w20 * c13
	d5, d13 := c5+t5, c5-t5
	t6 := w24 * c14
	d6, d14 := c6+t6, c6-t6
	t7 := w28 * c15
	d7, d15 := c7+t7, c7-t7
	d16, d24 := c16+c24, c16-c24
	t17 = w4 * c25
	d17, d25 := c17+t17, c17-t17
	t18 = w8 * c26
	d18, d26 := c18+t18, c18-t18
	t19 = w12 * c27
	d19, d27 := c19+t19, c19-t19
	t20 := w16 * c28
	d20, d28 := c20+t20, c20-t20
	t21 = w20 * c29
	d21, d29 := c21+t21, c21-t21
	t22 := w24 * c30
	d22, d30 := c22+t22, c22-t22
	t23 := w28 * c31
	d23, d31 := c23+t23, c23-t23
	d32, d40 := c32+c40, c32-c40
	t33 = w4 * c41
	d33, d41 := c33+t33, c33-t33
	t34 = w8 * c42
	d34, d42 := c34+t34, c34-t34
	t35 = w12 * c43
	d35, d43 := c35+t35, c35-t35
	t36 := w16 * c44
	d36, d44 := c36+t36, c36-t36
	t37 = w20 * c45
	d37, d45 := c37+t37, c37-t37
	t38 := w24 * c46
	d38, d46 := c38+t38, c38-t38
	t39 := w28 * c47
	d39, d47 := c39+t39, c39-t39
	d48, d56 := c48+c56, c48-c56
	t49 = w4 * c57
	d49, d57 := c49+t49, c49-t49
	t50 = w8 * c58
	d50, d58 := c50+t50, c50-t50
	t51 = w12 * c59
	d51, d59 := c51+t51, c51-t51
	t52 := w16 * c60
	d52, d60 := c52+t52, c52-t52
	t53 = w20 * c61
	d53, d61 := c53+t53, c53-t53
	t54 := w24 * c62
	d54, d62 := c54+t54, c54-t54
	t55 := w28 * c63
	d55, d63 := c55+t55, c55-t55

	// Stage 5 (size 32) - conjugate twiddles
	tw2 := twiddle[2]
	tw6 := twiddle[6]
	tw10 := twiddle[10]
	tw14 := twiddle[14]
	tw18 := twiddle[18]
	tw22 := twiddle[22]
	tw26 := twiddle[26]
	tw30 := twiddle[30]
	w2 := complex(real(tw2), -imag(tw2))
	w6 := complex(real(tw6), -imag(tw6))
	w10 := complex(real(tw10), -imag(tw10))
	w14 := complex(real(tw14), -imag(tw14))
	w18 := complex(real(tw18), -imag(tw18))
	w22 := complex(real(tw22), -imag(tw22))
	w26 := complex(real(tw26), -imag(tw26))
	w30 := complex(real(tw30), -imag(tw30))
	e0, e16 := d0+d16, d0-d16
	t1 = w2 * d17
	e1, e17 := d1+t1, d1-t1
	t2 = w4 * d18
	e2, e18 := d2+t2, d2-t2
	t3 = w6 * d19
	e3, e19 := d3+t3, d3-t3
	t4 = w8 * d20
	e4, e20 := d4+t4, d4-t4
	t5 = w10 * d21
	e5, e21 := d5+t5, d5-t5
	t6 = w12 * d22
	e6, e22 := d6+t6, d6-t6
	t7 = w14 * d23
	e7, e23 := d7+t7, d7-t7
	t8 := w16 * d24
	e8, e24 := d8+t8, d8-t8
	t9 = w18 * d25
	e9, e25 := d9+t9, d9-t9
	t10 = w20 * d26
	e10, e26 := d10+t10, d10-t10
	t11 = w22 * d27
	e11, e27 := d11+t11, d11-t11
	t12 := w24 * d28
	e12, e28 := d12+t12, d12-t12
	t13 = w26 * d29
	e13, e29 := d13+t13, d13-t13
	t14 := w28 * d30
	e14, e30 := d14+t14, d14-t14
	t15 := w30 * d31
	e15, e31 := d15+t15, d15-t15
	e32, e48 := d32+d48, d32-d48
	t33 = w2 * d49
	e33, e49 := d33+t33, d33-t33
	t34 = w4 * d50
	e34, e50 := d34+t34, d34-t34
	t35 = w6 * d51
	e35, e51 := d35+t35, d35-t35
	t36 = w8 * d52
	e36, e52 := d36+t36, d36-t36
	t37 = w10 * d53
	e37, e53 := d37+t37, d37-t37
	t38 = w12 * d54
	e38, e54 := d38+t38, d38-t38
	t39 = w14 * d55
	e39, e55 := d39+t39, d39-t39
	t40 := w16 * d56
	e40, e56 := d40+t40, d40-t40
	t41 = w18 * d57
	e41, e57 := d41+t41, d41-t41
	t42 = w20 * d58
	e42, e58 := d42+t42, d42-t42
	t43 = w22 * d59
	e43, e59 := d43+t43, d43-t43
	t44 := w24 * d60
	e44, e60 := d44+t44, d44-t44
	t45 = w26 * d61
	e45, e61 := d45+t45, d45-t45
	t46 := w28 * d62
	e46, e62 := d46+t46, d46-t46
	t47 := w30 * d63
	e47, e63 := d47+t47, d47-t47

	// Stage 6 (size 64) - conjugate twiddles and scale by 1/64
	tw1 := twiddle[1]
	tw3 := twiddle[3]
	tw5 := twiddle[5]
	tw7 := twiddle[7]
	tw9 := twiddle[9]
	tw11 := twiddle[11]
	tw13 := twiddle[13]
	tw15 := twiddle[15]
	tw17 := twiddle[17]
	tw19 := twiddle[19]
	tw21 := twiddle[21]
	tw23 := twiddle[23]
	tw25 := twiddle[25]
	tw27 := twiddle[27]
	tw29 := twiddle[29]
	tw31 := twiddle[31]
	w1 := complex(real(tw1), -imag(tw1))
	w3 := complex(real(tw3), -imag(tw3))
	w5 := complex(real(tw5), -imag(tw5))
	w7 := complex(real(tw7), -imag(tw7))
	w9 := complex(real(tw9), -imag(tw9))
	w11 := complex(real(tw11), -imag(tw11))
	w13 := complex(real(tw13), -imag(tw13))
	w15 := complex(real(tw15), -imag(tw15))
	w17 := complex(real(tw17), -imag(tw17))
	w19 := complex(real(tw19), -imag(tw19))
	w21 := complex(real(tw21), -imag(tw21))
	w23 := complex(real(tw23), -imag(tw23))
	w25 := complex(real(tw25), -imag(tw25))
	w27 := complex(real(tw27), -imag(tw27))
	w29 := complex(real(tw29), -imag(tw29))
	w31 := complex(real(tw31), -imag(tw31))

	scale := complex(float32(1.0/64.0), 0)
	work = work[:n]

	f0, f32 := e0+e32, e0-e32
	work[0], work[32] = f0*scale, f32*scale
	t1 = w1 * e33
	f1, f33 := e1+t1, e1-t1
	work[1], work[33] = f1*scale, f33*scale
	t2 = w2 * e34
	f2, f34 := e2+t2, e2-t2
	work[2], work[34] = f2*scale, f34*scale
	t3 = w3 * e35
	f3, f35 := e3+t3, e3-t3
	work[3], work[35] = f3*scale, f35*scale
	t4 = w4 * e36
	f4, f36 := e4+t4, e4-t4
	work[4], work[36] = f4*scale, f36*scale
	t5 = w5 * e37
	f5, f37 := e5+t5, e5-t5
	work[5], work[37] = f5*scale, f37*scale
	t6 = w6 * e38
	f6, f38 := e6+t6, e6-t6
	work[6], work[38] = f6*scale, f38*scale
	t7 = w7 * e39
	f7, f39 := e7+t7, e7-t7
	work[7], work[39] = f7*scale, f39*scale
	t8 = w8 * e40
	f8, f40 := e8+t8, e8-t8
	work[8], work[40] = f8*scale, f40*scale
	t9 = w9 * e41
	f9, f41 := e9+t9, e9-t9
	work[9], work[41] = f9*scale, f41*scale
	t10 = w10 * e42
	f10, f42 := e10+t10, e10-t10
	work[10], work[42] = f10*scale, f42*scale
	t11 = w11 * e43
	f11, f43 := e11+t11, e11-t11
	work[11], work[43] = f11*scale, f43*scale
	t12 = w12 * e44
	f12, f44 := e12+t12, e12-t12
	work[12], work[44] = f12*scale, f44*scale
	t13 = w13 * e45
	f13, f45 := e13+t13, e13-t13
	work[13], work[45] = f13*scale, f45*scale
	t14 = w14 * e46
	f14, f46 := e14+t14, e14-t14
	work[14], work[46] = f14*scale, f46*scale
	t15 = w15 * e47
	f15, f47 := e15+t15, e15-t15
	work[15], work[47] = f15*scale, f47*scale
	t16 := w16 * e48
	f16, f48 := e16+t16, e16-t16
	work[16], work[48] = f16*scale, f48*scale
	t17 = w17 * e49
	f17, f49 := e17+t17, e17-t17
	work[17], work[49] = f17*scale, f49*scale
	t18 = w18 * e50
	f18, f50 := e18+t18, e18-t18
	work[18], work[50] = f18*scale, f50*scale
	t19 = w19 * e51
	f19, f51 := e19+t19, e19-t19
	work[19], work[51] = f19*scale, f51*scale
	t20 = w20 * e52
	f20, f52 := e20+t20, e20-t20
	work[20], work[52] = f20*scale, f52*scale
	t21 = w21 * e53
	f21, f53 := e21+t21, e21-t21
	work[21], work[53] = f21*scale, f53*scale
	t22 = w22 * e54
	f22, f54 := e22+t22, e22-t22
	work[22], work[54] = f22*scale, f54*scale
	t23 = w23 * e55
	f23, f55 := e23+t23, e23-t23
	work[23], work[55] = f23*scale, f55*scale
	t24 := w24 * e56
	f24, f56 := e24+t24, e24-t24
	work[24], work[56] = f24*scale, f56*scale
	t25 = w25 * e57
	f25, f57 := e25+t25, e25-t25
	work[25], work[57] = f25*scale, f57*scale
	t26 = w26 * e58
	f26, f58 := e26+t26, e26-t26
	work[26], work[58] = f26*scale, f58*scale
	t27 = w27 * e59
	f27, f59 := e27+t27, e27-t27
	work[27], work[59] = f27*scale, f59*scale
	t28 := w28 * e60
	f28, f60 := e28+t28, e28-t28
	work[28], work[60] = f28*scale, f60*scale
	t29 = w29 * e61
	f29, f61 := e29+t29, e29-t29
	work[29], work[61] = f29*scale, f61*scale
	t30 := w30 * e62
	f30, f62 := e30+t30, e30-t30
	work[30], work[62] = f30*scale, f62*scale
	t31 := w31 * e63
	f31, f63 := e31+t31, e31-t31
	work[31], work[63] = f31*scale, f63*scale

	if !workIsDst {
		copy(dst, work)
	}

	return true
}

//nolint:funlen
func forwardDIT64Complex128(dst, src, twiddle, scratch []complex128, bitrev []int) bool {
	const n = 64

	if len(dst) < n || len(twiddle) < n || len(scratch) < n || len(bitrev) < n || len(src) < n {
		return false
	}

	work := dst
	workIsDst := true

	if sameSlice(dst, src) {
		work = scratch
		workIsDst = false
	}

	br := bitrev[:n]
	s := src[:n]

	// Load all 64 elements with bit-reversal
	x0 := s[br[0]]
	x1 := s[br[1]]
	x2 := s[br[2]]
	x3 := s[br[3]]
	x4 := s[br[4]]
	x5 := s[br[5]]
	x6 := s[br[6]]
	x7 := s[br[7]]
	x8 := s[br[8]]
	x9 := s[br[9]]
	x10 := s[br[10]]
	x11 := s[br[11]]
	x12 := s[br[12]]
	x13 := s[br[13]]
	x14 := s[br[14]]
	x15 := s[br[15]]
	x16 := s[br[16]]
	x17 := s[br[17]]
	x18 := s[br[18]]
	x19 := s[br[19]]
	x20 := s[br[20]]
	x21 := s[br[21]]
	x22 := s[br[22]]
	x23 := s[br[23]]
	x24 := s[br[24]]
	x25 := s[br[25]]
	x26 := s[br[26]]
	x27 := s[br[27]]
	x28 := s[br[28]]
	x29 := s[br[29]]
	x30 := s[br[30]]
	x31 := s[br[31]]
	x32 := s[br[32]]
	x33 := s[br[33]]
	x34 := s[br[34]]
	x35 := s[br[35]]
	x36 := s[br[36]]
	x37 := s[br[37]]
	x38 := s[br[38]]
	x39 := s[br[39]]
	x40 := s[br[40]]
	x41 := s[br[41]]
	x42 := s[br[42]]
	x43 := s[br[43]]
	x44 := s[br[44]]
	x45 := s[br[45]]
	x46 := s[br[46]]
	x47 := s[br[47]]
	x48 := s[br[48]]
	x49 := s[br[49]]
	x50 := s[br[50]]
	x51 := s[br[51]]
	x52 := s[br[52]]
	x53 := s[br[53]]
	x54 := s[br[54]]
	x55 := s[br[55]]
	x56 := s[br[56]]
	x57 := s[br[57]]
	x58 := s[br[58]]
	x59 := s[br[59]]
	x60 := s[br[60]]
	x61 := s[br[61]]
	x62 := s[br[62]]
	x63 := s[br[63]]

	// Stage 1 (size 2)
	a0, a1 := x0+x1, x0-x1
	a2, a3 := x2+x3, x2-x3
	a4, a5 := x4+x5, x4-x5
	a6, a7 := x6+x7, x6-x7
	a8, a9 := x8+x9, x8-x9
	a10, a11 := x10+x11, x10-x11
	a12, a13 := x12+x13, x12-x13
	a14, a15 := x14+x15, x14-x15
	a16, a17 := x16+x17, x16-x17
	a18, a19 := x18+x19, x18-x19
	a20, a21 := x20+x21, x20-x21
	a22, a23 := x22+x23, x22-x23
	a24, a25 := x24+x25, x24-x25
	a26, a27 := x26+x27, x26-x27
	a28, a29 := x28+x29, x28-x29
	a30, a31 := x30+x31, x30-x31
	a32, a33 := x32+x33, x32-x33
	a34, a35 := x34+x35, x34-x35
	a36, a37 := x36+x37, x36-x37
	a38, a39 := x38+x39, x38-x39
	a40, a41 := x40+x41, x40-x41
	a42, a43 := x42+x43, x42-x43
	a44, a45 := x44+x45, x44-x45
	a46, a47 := x46+x47, x46-x47
	a48, a49 := x48+x49, x48-x49
	a50, a51 := x50+x51, x50-x51
	a52, a53 := x52+x53, x52-x53
	a54, a55 := x54+x55, x54-x55
	a56, a57 := x56+x57, x56-x57
	a58, a59 := x58+x59, x58-x59
	a60, a61 := x60+x61, x60-x61
	a62, a63 := x62+x63, x62-x63

	// Stage 2 (size 4)
	w16 := twiddle[16]
	b0, b2 := a0+a2, a0-a2
	t1 := w16 * a3
	b1, b3 := a1+t1, a1-t1
	b4, b6 := a4+a6, a4-a6
	t5 := w16 * a7
	b5, b7 := a5+t5, a5-t5
	b8, b10 := a8+a10, a8-a10
	t9 := w16 * a11
	b9, b11 := a9+t9, a9-t9
	b12, b14 := a12+a14, a12-a14
	t13 := w16 * a15
	b13, b15 := a13+t13, a13-t13
	b16, b18 := a16+a18, a16-a18
	t17 := w16 * a19
	b17, b19 := a17+t17, a17-t17
	b20, b22 := a20+a22, a20-a22
	t21 := w16 * a23
	b21, b23 := a21+t21, a21-t21
	b24, b26 := a24+a26, a24-a26
	t25 := w16 * a27
	b25, b27 := a25+t25, a25-t25
	b28, b30 := a28+a30, a28-a30
	t29 := w16 * a31
	b29, b31 := a29+t29, a29-t29
	b32, b34 := a32+a34, a32-a34
	t33 := w16 * a35
	b33, b35 := a33+t33, a33-t33
	b36, b38 := a36+a38, a36-a38
	t37 := w16 * a39
	b37, b39 := a37+t37, a37-t37
	b40, b42 := a40+a42, a40-a42
	t41 := w16 * a43
	b41, b43 := a41+t41, a41-t41
	b44, b46 := a44+a46, a44-a46
	t45 := w16 * a47
	b45, b47 := a45+t45, a45-t45
	b48, b50 := a48+a50, a48-a50
	t49 := w16 * a51
	b49, b51 := a49+t49, a49-t49
	b52, b54 := a52+a54, a52-a54
	t53 := w16 * a55
	b53, b55 := a53+t53, a53-t53
	b56, b58 := a56+a58, a56-a58
	t57 := w16 * a59
	b57, b59 := a57+t57, a57-t57
	b60, b62 := a60+a62, a60-a62
	t61 := w16 * a63
	b61, b63 := a61+t61, a61-t61

	// Stage 3 (size 8)
	w8 := twiddle[8]
	w24 := twiddle[24]
	c0, c4 := b0+b4, b0-b4
	t1 = w8 * b5
	c1, c5 := b1+t1, b1-t1
	t2 := w16 * b6
	c2, c6 := b2+t2, b2-t2
	t3 := w24 * b7
	c3, c7 := b3+t3, b3-t3
	c8, c12 := b8+b12, b8-b12
	t9 = w8 * b13
	c9, c13 := b9+t9, b9-t9
	t10 := w16 * b14
	c10, c14 := b10+t10, b10-t10
	t11 := w24 * b15
	c11, c15 := b11+t11, b11-t11
	c16, c20 := b16+b20, b16-b20
	t17 = w8 * b21
	c17, c21 := b17+t17, b17-t17
	t18 := w16 * b22
	c18, c22 := b18+t18, b18-t18
	t19 := w24 * b23
	c19, c23 := b19+t19, b19-t19
	c24, c28 := b24+b28, b24-b28
	t25 = w8 * b29
	c25, c29 := b25+t25, b25-t25
	t26 := w16 * b30
	c26, c30 := b26+t26, b26-t26
	t27 := w24 * b31
	c27, c31 := b27+t27, b27-t27
	c32, c36 := b32+b36, b32-b36
	t33 = w8 * b37
	c33, c37 := b33+t33, b33-t33
	t34 := w16 * b38
	c34, c38 := b34+t34, b34-t34
	t35 := w24 * b39
	c35, c39 := b35+t35, b35-t35
	c40, c44 := b40+b44, b40-b44
	t41 = w8 * b45
	c41, c45 := b41+t41, b41-t41
	t42 := w16 * b46
	c42, c46 := b42+t42, b42-t42
	t43 := w24 * b47
	c43, c47 := b43+t43, b43-t43
	c48, c52 := b48+b52, b48-b52
	t49 = w8 * b53
	c49, c53 := b49+t49, b49-t49
	t50 := w16 * b54
	c50, c54 := b50+t50, b50-t50
	t51 := w24 * b55
	c51, c55 := b51+t51, b51-t51
	c56, c60 := b56+b60, b56-b60
	t57 = w8 * b61
	c57, c61 := b57+t57, b57-t57
	t58 := w16 * b62
	c58, c62 := b58+t58, b58-t58
	t59 := w24 * b63
	c59, c63 := b59+t59, b59-t59

	// Stage 4 (size 16)
	w4 := twiddle[4]
	w12 := twiddle[12]
	w20 := twiddle[20]
	w28 := twiddle[28]
	d0, d8 := c0+c8, c0-c8
	t1 = w4 * c9
	d1, d9 := c1+t1, c1-t1
	t2 = w8 * c10
	d2, d10 := c2+t2, c2-t2
	t3 = w12 * c11
	d3, d11 := c3+t3, c3-t3
	t4 := w16 * c12
	d4, d12 := c4+t4, c4-t4
	t5 = w20 * c13
	d5, d13 := c5+t5, c5-t5
	t6 := w24 * c14
	d6, d14 := c6+t6, c6-t6
	t7 := w28 * c15
	d7, d15 := c7+t7, c7-t7
	d16, d24 := c16+c24, c16-c24
	t17 = w4 * c25
	d17, d25 := c17+t17, c17-t17
	t18 = w8 * c26
	d18, d26 := c18+t18, c18-t18
	t19 = w12 * c27
	d19, d27 := c19+t19, c19-t19
	t20 := w16 * c28
	d20, d28 := c20+t20, c20-t20
	t21 = w20 * c29
	d21, d29 := c21+t21, c21-t21
	t22 := w24 * c30
	d22, d30 := c22+t22, c22-t22
	t23 := w28 * c31
	d23, d31 := c23+t23, c23-t23
	d32, d40 := c32+c40, c32-c40
	t33 = w4 * c41
	d33, d41 := c33+t33, c33-t33
	t34 = w8 * c42
	d34, d42 := c34+t34, c34-t34
	t35 = w12 * c43
	d35, d43 := c35+t35, c35-t35
	t36 := w16 * c44
	d36, d44 := c36+t36, c36-t36
	t37 = w20 * c45
	d37, d45 := c37+t37, c37-t37
	t38 := w24 * c46
	d38, d46 := c38+t38, c38-t38
	t39 := w28 * c47
	d39, d47 := c39+t39, c39-t39
	d48, d56 := c48+c56, c48-c56
	t49 = w4 * c57
	d49, d57 := c49+t49, c49-t49
	t50 = w8 * c58
	d50, d58 := c50+t50, c50-t50
	t51 = w12 * c59
	d51, d59 := c51+t51, c51-t51
	t52 := w16 * c60
	d52, d60 := c52+t52, c52-t52
	t53 = w20 * c61
	d53, d61 := c53+t53, c53-t53
	t54 := w24 * c62
	d54, d62 := c54+t54, c54-t54
	t55 := w28 * c63
	d55, d63 := c55+t55, c55-t55

	// Stage 5 (size 32)
	w2 := twiddle[2]
	w6 := twiddle[6]
	w10 := twiddle[10]
	w14 := twiddle[14]
	w18 := twiddle[18]
	w22 := twiddle[22]
	w26 := twiddle[26]
	w30 := twiddle[30]
	e0, e16 := d0+d16, d0-d16
	t1 = w2 * d17
	e1, e17 := d1+t1, d1-t1
	t2 = w4 * d18
	e2, e18 := d2+t2, d2-t2
	t3 = w6 * d19
	e3, e19 := d3+t3, d3-t3
	t4 = w8 * d20
	e4, e20 := d4+t4, d4-t4
	t5 = w10 * d21
	e5, e21 := d5+t5, d5-t5
	t6 = w12 * d22
	e6, e22 := d6+t6, d6-t6
	t7 = w14 * d23
	e7, e23 := d7+t7, d7-t7
	t8 := w16 * d24
	e8, e24 := d8+t8, d8-t8
	t9 = w18 * d25
	e9, e25 := d9+t9, d9-t9
	t10 = w20 * d26
	e10, e26 := d10+t10, d10-t10
	t11 = w22 * d27
	e11, e27 := d11+t11, d11-t11
	t12 := w24 * d28
	e12, e28 := d12+t12, d12-t12
	t13 = w26 * d29
	e13, e29 := d13+t13, d13-t13
	t14 := w28 * d30
	e14, e30 := d14+t14, d14-t14
	t15 := w30 * d31
	e15, e31 := d15+t15, d15-t15
	e32, e48 := d32+d48, d32-d48
	t33 = w2 * d49
	e33, e49 := d33+t33, d33-t33
	t34 = w4 * d50
	e34, e50 := d34+t34, d34-t34
	t35 = w6 * d51
	e35, e51 := d35+t35, d35-t35
	t36 = w8 * d52
	e36, e52 := d36+t36, d36-t36
	t37 = w10 * d53
	e37, e53 := d37+t37, d37-t37
	t38 = w12 * d54
	e38, e54 := d38+t38, d38-t38
	t39 = w14 * d55
	e39, e55 := d39+t39, d39-t39
	t40 := w16 * d56
	e40, e56 := d40+t40, d40-t40
	t41 = w18 * d57
	e41, e57 := d41+t41, d41-t41
	t42 = w20 * d58
	e42, e58 := d42+t42, d42-t42
	t43 = w22 * d59
	e43, e59 := d43+t43, d43-t43
	t44 := w24 * d60
	e44, e60 := d44+t44, d44-t44
	t45 = w26 * d61
	e45, e61 := d45+t45, d45-t45
	t46 := w28 * d62
	e46, e62 := d46+t46, d46-t46
	t47 := w30 * d63
	e47, e63 := d47+t47, d47-t47

	// Stage 6 (size 64)
	w1 := twiddle[1]
	w3 := twiddle[3]
	w5 := twiddle[5]
	w7 := twiddle[7]
	w9 := twiddle[9]
	w11 := twiddle[11]
	w13 := twiddle[13]
	w15 := twiddle[15]
	w17 := twiddle[17]
	w19 := twiddle[19]
	w21 := twiddle[21]
	w23 := twiddle[23]
	w25 := twiddle[25]
	w27 := twiddle[27]
	w29 := twiddle[29]
	w31 := twiddle[31]

	work = work[:n]
	work[0], work[32] = e0+e32, e0-e32
	t1 = w1 * e33
	work[1], work[33] = e1+t1, e1-t1
	t2 = w2 * e34
	work[2], work[34] = e2+t2, e2-t2
	t3 = w3 * e35
	work[3], work[35] = e3+t3, e3-t3
	t4 = w4 * e36
	work[4], work[36] = e4+t4, e4-t4
	t5 = w5 * e37
	work[5], work[37] = e5+t5, e5-t5
	t6 = w6 * e38
	work[6], work[38] = e6+t6, e6-t6
	t7 = w7 * e39
	work[7], work[39] = e7+t7, e7-t7
	t8 = w8 * e40
	work[8], work[40] = e8+t8, e8-t8
	t9 = w9 * e41
	work[9], work[41] = e9+t9, e9-t9
	t10 = w10 * e42
	work[10], work[42] = e10+t10, e10-t10
	t11 = w11 * e43
	work[11], work[43] = e11+t11, e11-t11
	t12 = w12 * e44
	work[12], work[44] = e12+t12, e12-t12
	t13 = w13 * e45
	work[13], work[45] = e13+t13, e13-t13
	t14 = w14 * e46
	work[14], work[46] = e14+t14, e14-t14
	t15 = w15 * e47
	work[15], work[47] = e15+t15, e15-t15
	t16 := w16 * e48
	work[16], work[48] = e16+t16, e16-t16
	t17 = w17 * e49
	work[17], work[49] = e17+t17, e17-t17
	t18 = w18 * e50
	work[18], work[50] = e18+t18, e18-t18
	t19 = w19 * e51
	work[19], work[51] = e19+t19, e19-t19
	t20 = w20 * e52
	work[20], work[52] = e20+t20, e20-t20
	t21 = w21 * e53
	work[21], work[53] = e21+t21, e21-t21
	t22 = w22 * e54
	work[22], work[54] = e22+t22, e22-t22
	t23 = w23 * e55
	work[23], work[55] = e23+t23, e23-t23
	t24 := w24 * e56
	work[24], work[56] = e24+t24, e24-t24
	t25 = w25 * e57
	work[25], work[57] = e25+t25, e25-t25
	t26 = w26 * e58
	work[26], work[58] = e26+t26, e26-t26
	t27 = w27 * e59
	work[27], work[59] = e27+t27, e27-t27
	t28 := w28 * e60
	work[28], work[60] = e28+t28, e28-t28
	t29 = w29 * e61
	work[29], work[61] = e29+t29, e29-t29
	t30 := w30 * e62
	work[30], work[62] = e30+t30, e30-t30
	t31 := w31 * e63
	work[31], work[63] = e31+t31, e31-t31

	if !workIsDst {
		copy(dst, work)
	}

	return true
}

//nolint:funlen
func inverseDIT64Complex128(dst, src, twiddle, scratch []complex128, bitrev []int) bool {
	const n = 64

	if len(dst) < n || len(twiddle) < n || len(scratch) < n || len(bitrev) < n || len(src) < n {
		return false
	}

	work := dst
	workIsDst := true

	if sameSlice(dst, src) {
		work = scratch
		workIsDst = false
	}

	br := bitrev[:n]
	s := src[:n]

	// Load all 64 elements with bit-reversal
	x0 := s[br[0]]
	x1 := s[br[1]]
	x2 := s[br[2]]
	x3 := s[br[3]]
	x4 := s[br[4]]
	x5 := s[br[5]]
	x6 := s[br[6]]
	x7 := s[br[7]]
	x8 := s[br[8]]
	x9 := s[br[9]]
	x10 := s[br[10]]
	x11 := s[br[11]]
	x12 := s[br[12]]
	x13 := s[br[13]]
	x14 := s[br[14]]
	x15 := s[br[15]]
	x16 := s[br[16]]
	x17 := s[br[17]]
	x18 := s[br[18]]
	x19 := s[br[19]]
	x20 := s[br[20]]
	x21 := s[br[21]]
	x22 := s[br[22]]
	x23 := s[br[23]]
	x24 := s[br[24]]
	x25 := s[br[25]]
	x26 := s[br[26]]
	x27 := s[br[27]]
	x28 := s[br[28]]
	x29 := s[br[29]]
	x30 := s[br[30]]
	x31 := s[br[31]]
	x32 := s[br[32]]
	x33 := s[br[33]]
	x34 := s[br[34]]
	x35 := s[br[35]]
	x36 := s[br[36]]
	x37 := s[br[37]]
	x38 := s[br[38]]
	x39 := s[br[39]]
	x40 := s[br[40]]
	x41 := s[br[41]]
	x42 := s[br[42]]
	x43 := s[br[43]]
	x44 := s[br[44]]
	x45 := s[br[45]]
	x46 := s[br[46]]
	x47 := s[br[47]]
	x48 := s[br[48]]
	x49 := s[br[49]]
	x50 := s[br[50]]
	x51 := s[br[51]]
	x52 := s[br[52]]
	x53 := s[br[53]]
	x54 := s[br[54]]
	x55 := s[br[55]]
	x56 := s[br[56]]
	x57 := s[br[57]]
	x58 := s[br[58]]
	x59 := s[br[59]]
	x60 := s[br[60]]
	x61 := s[br[61]]
	x62 := s[br[62]]
	x63 := s[br[63]]

	// Stage 1 (size 2)
	a0, a1 := x0+x1, x0-x1
	a2, a3 := x2+x3, x2-x3
	a4, a5 := x4+x5, x4-x5
	a6, a7 := x6+x7, x6-x7
	a8, a9 := x8+x9, x8-x9
	a10, a11 := x10+x11, x10-x11
	a12, a13 := x12+x13, x12-x13
	a14, a15 := x14+x15, x14-x15
	a16, a17 := x16+x17, x16-x17
	a18, a19 := x18+x19, x18-x19
	a20, a21 := x20+x21, x20-x21
	a22, a23 := x22+x23, x22-x23
	a24, a25 := x24+x25, x24-x25
	a26, a27 := x26+x27, x26-x27
	a28, a29 := x28+x29, x28-x29
	a30, a31 := x30+x31, x30-x31
	a32, a33 := x32+x33, x32-x33
	a34, a35 := x34+x35, x34-x35
	a36, a37 := x36+x37, x36-x37
	a38, a39 := x38+x39, x38-x39
	a40, a41 := x40+x41, x40-x41
	a42, a43 := x42+x43, x42-x43
	a44, a45 := x44+x45, x44-x45
	a46, a47 := x46+x47, x46-x47
	a48, a49 := x48+x49, x48-x49
	a50, a51 := x50+x51, x50-x51
	a52, a53 := x52+x53, x52-x53
	a54, a55 := x54+x55, x54-x55
	a56, a57 := x56+x57, x56-x57
	a58, a59 := x58+x59, x58-x59
	a60, a61 := x60+x61, x60-x61
	a62, a63 := x62+x63, x62-x63

	// Stage 2 (size 4) - conjugate twiddle
	tw16 := twiddle[16]
	w16 := complex(real(tw16), -imag(tw16))
	b0, b2 := a0+a2, a0-a2
	t1 := w16 * a3
	b1, b3 := a1+t1, a1-t1
	b4, b6 := a4+a6, a4-a6
	t5 := w16 * a7
	b5, b7 := a5+t5, a5-t5
	b8, b10 := a8+a10, a8-a10
	t9 := w16 * a11
	b9, b11 := a9+t9, a9-t9
	b12, b14 := a12+a14, a12-a14
	t13 := w16 * a15
	b13, b15 := a13+t13, a13-t13
	b16, b18 := a16+a18, a16-a18
	t17 := w16 * a19
	b17, b19 := a17+t17, a17-t17
	b20, b22 := a20+a22, a20-a22
	t21 := w16 * a23
	b21, b23 := a21+t21, a21-t21
	b24, b26 := a24+a26, a24-a26
	t25 := w16 * a27
	b25, b27 := a25+t25, a25-t25
	b28, b30 := a28+a30, a28-a30
	t29 := w16 * a31
	b29, b31 := a29+t29, a29-t29
	b32, b34 := a32+a34, a32-a34
	t33 := w16 * a35
	b33, b35 := a33+t33, a33-t33
	b36, b38 := a36+a38, a36-a38
	t37 := w16 * a39
	b37, b39 := a37+t37, a37-t37
	b40, b42 := a40+a42, a40-a42
	t41 := w16 * a43
	b41, b43 := a41+t41, a41-t41
	b44, b46 := a44+a46, a44-a46
	t45 := w16 * a47
	b45, b47 := a45+t45, a45-t45
	b48, b50 := a48+a50, a48-a50
	t49 := w16 * a51
	b49, b51 := a49+t49, a49-t49
	b52, b54 := a52+a54, a52-a54
	t53 := w16 * a55
	b53, b55 := a53+t53, a53-t53
	b56, b58 := a56+a58, a56-a58
	t57 := w16 * a59
	b57, b59 := a57+t57, a57-t57
	b60, b62 := a60+a62, a60-a62
	t61 := w16 * a63
	b61, b63 := a61+t61, a61-t61

	// Stage 3 (size 8) - conjugate twiddles
	tw8 := twiddle[8]
	tw24 := twiddle[24]
	w8 := complex(real(tw8), -imag(tw8))
	w24 := complex(real(tw24), -imag(tw24))
	c0, c4 := b0+b4, b0-b4
	t1 = w8 * b5
	c1, c5 := b1+t1, b1-t1
	t2 := w16 * b6
	c2, c6 := b2+t2, b2-t2
	t3 := w24 * b7
	c3, c7 := b3+t3, b3-t3
	c8, c12 := b8+b12, b8-b12
	t9 = w8 * b13
	c9, c13 := b9+t9, b9-t9
	t10 := w16 * b14
	c10, c14 := b10+t10, b10-t10
	t11 := w24 * b15
	c11, c15 := b11+t11, b11-t11
	c16, c20 := b16+b20, b16-b20
	t17 = w8 * b21
	c17, c21 := b17+t17, b17-t17
	t18 := w16 * b22
	c18, c22 := b18+t18, b18-t18
	t19 := w24 * b23
	c19, c23 := b19+t19, b19-t19
	c24, c28 := b24+b28, b24-b28
	t25 = w8 * b29
	c25, c29 := b25+t25, b25-t25
	t26 := w16 * b30
	c26, c30 := b26+t26, b26-t26
	t27 := w24 * b31
	c27, c31 := b27+t27, b27-t27
	c32, c36 := b32+b36, b32-b36
	t33 = w8 * b37
	c33, c37 := b33+t33, b33-t33
	t34 := w16 * b38
	c34, c38 := b34+t34, b34-t34
	t35 := w24 * b39
	c35, c39 := b35+t35, b35-t35
	c40, c44 := b40+b44, b40-b44
	t41 = w8 * b45
	c41, c45 := b41+t41, b41-t41
	t42 := w16 * b46
	c42, c46 := b42+t42, b42-t42
	t43 := w24 * b47
	c43, c47 := b43+t43, b43-t43
	c48, c52 := b48+b52, b48-b52
	t49 = w8 * b53
	c49, c53 := b49+t49, b49-t49
	t50 := w16 * b54
	c50, c54 := b50+t50, b50-t50
	t51 := w24 * b55
	c51, c55 := b51+t51, b51-t51
	c56, c60 := b56+b60, b56-b60
	t57 = w8 * b61
	c57, c61 := b57+t57, b57-t57
	t58 := w16 * b62
	c58, c62 := b58+t58, b58-t58
	t59 := w24 * b63
	c59, c63 := b59+t59, b59-t59

	// Stage 4 (size 16) - conjugate twiddles
	tw4 := twiddle[4]
	tw12 := twiddle[12]
	tw20 := twiddle[20]
	tw28 := twiddle[28]
	w4 := complex(real(tw4), -imag(tw4))
	w12 := complex(real(tw12), -imag(tw12))
	w20 := complex(real(tw20), -imag(tw20))
	w28 := complex(real(tw28), -imag(tw28))
	d0, d8 := c0+c8, c0-c8
	t1 = w4 * c9
	d1, d9 := c1+t1, c1-t1
	t2 = w8 * c10
	d2, d10 := c2+t2, c2-t2
	t3 = w12 * c11
	d3, d11 := c3+t3, c3-t3
	t4 := w16 * c12
	d4, d12 := c4+t4, c4-t4
	t5 = w20 * c13
	d5, d13 := c5+t5, c5-t5
	t6 := w24 * c14
	d6, d14 := c6+t6, c6-t6
	t7 := w28 * c15
	d7, d15 := c7+t7, c7-t7
	d16, d24 := c16+c24, c16-c24
	t17 = w4 * c25
	d17, d25 := c17+t17, c17-t17
	t18 = w8 * c26
	d18, d26 := c18+t18, c18-t18
	t19 = w12 * c27
	d19, d27 := c19+t19, c19-t19
	t20 := w16 * c28
	d20, d28 := c20+t20, c20-t20
	t21 = w20 * c29
	d21, d29 := c21+t21, c21-t21
	t22 := w24 * c30
	d22, d30 := c22+t22, c22-t22
	t23 := w28 * c31
	d23, d31 := c23+t23, c23-t23
	d32, d40 := c32+c40, c32-c40
	t33 = w4 * c41
	d33, d41 := c33+t33, c33-t33
	t34 = w8 * c42
	d34, d42 := c34+t34, c34-t34
	t35 = w12 * c43
	d35, d43 := c35+t35, c35-t35
	t36 := w16 * c44
	d36, d44 := c36+t36, c36-t36
	t37 = w20 * c45
	d37, d45 := c37+t37, c37-t37
	t38 := w24 * c46
	d38, d46 := c38+t38, c38-t38
	t39 := w28 * c47
	d39, d47 := c39+t39, c39-t39
	d48, d56 := c48+c56, c48-c56
	t49 = w4 * c57
	d49, d57 := c49+t49, c49-t49
	t50 = w8 * c58
	d50, d58 := c50+t50, c50-t50
	t51 = w12 * c59
	d51, d59 := c51+t51, c51-t51
	t52 := w16 * c60
	d52, d60 := c52+t52, c52-t52
	t53 = w20 * c61
	d53, d61 := c53+t53, c53-t53
	t54 := w24 * c62
	d54, d62 := c54+t54, c54-t54
	t55 := w28 * c63
	d55, d63 := c55+t55, c55-t55

	// Stage 5 (size 32) - conjugate twiddles
	tw2 := twiddle[2]
	tw6 := twiddle[6]
	tw10 := twiddle[10]
	tw14 := twiddle[14]
	tw18 := twiddle[18]
	tw22 := twiddle[22]
	tw26 := twiddle[26]
	tw30 := twiddle[30]
	w2 := complex(real(tw2), -imag(tw2))
	w6 := complex(real(tw6), -imag(tw6))
	w10 := complex(real(tw10), -imag(tw10))
	w14 := complex(real(tw14), -imag(tw14))
	w18 := complex(real(tw18), -imag(tw18))
	w22 := complex(real(tw22), -imag(tw22))
	w26 := complex(real(tw26), -imag(tw26))
	w30 := complex(real(tw30), -imag(tw30))
	e0, e16 := d0+d16, d0-d16
	t1 = w2 * d17
	e1, e17 := d1+t1, d1-t1
	t2 = w4 * d18
	e2, e18 := d2+t2, d2-t2
	t3 = w6 * d19
	e3, e19 := d3+t3, d3-t3
	t4 = w8 * d20
	e4, e20 := d4+t4, d4-t4
	t5 = w10 * d21
	e5, e21 := d5+t5, d5-t5
	t6 = w12 * d22
	e6, e22 := d6+t6, d6-t6
	t7 = w14 * d23
	e7, e23 := d7+t7, d7-t7
	t8 := w16 * d24
	e8, e24 := d8+t8, d8-t8
	t9 = w18 * d25
	e9, e25 := d9+t9, d9-t9
	t10 = w20 * d26
	e10, e26 := d10+t10, d10-t10
	t11 = w22 * d27
	e11, e27 := d11+t11, d11-t11
	t12 := w24 * d28
	e12, e28 := d12+t12, d12-t12
	t13 = w26 * d29
	e13, e29 := d13+t13, d13-t13
	t14 := w28 * d30
	e14, e30 := d14+t14, d14-t14
	t15 := w30 * d31
	e15, e31 := d15+t15, d15-t15
	e32, e48 := d32+d48, d32-d48
	t33 = w2 * d49
	e33, e49 := d33+t33, d33-t33
	t34 = w4 * d50
	e34, e50 := d34+t34, d34-t34
	t35 = w6 * d51
	e35, e51 := d35+t35, d35-t35
	t36 = w8 * d52
	e36, e52 := d36+t36, d36-t36
	t37 = w10 * d53
	e37, e53 := d37+t37, d37-t37
	t38 = w12 * d54
	e38, e54 := d38+t38, d38-t38
	t39 = w14 * d55
	e39, e55 := d39+t39, d39-t39
	t40 := w16 * d56
	e40, e56 := d40+t40, d40-t40
	t41 = w18 * d57
	e41, e57 := d41+t41, d41-t41
	t42 = w20 * d58
	e42, e58 := d42+t42, d42-t42
	t43 = w22 * d59
	e43, e59 := d43+t43, d43-t43
	t44 := w24 * d60
	e44, e60 := d44+t44, d44-t44
	t45 = w26 * d61
	e45, e61 := d45+t45, d45-t45
	t46 := w28 * d62
	e46, e62 := d46+t46, d46-t46
	t47 := w30 * d63
	e47, e63 := d47+t47, d47-t47

	// Stage 6 (size 64) - conjugate twiddles and scale by 1/64
	tw1 := twiddle[1]
	tw3 := twiddle[3]
	tw5 := twiddle[5]
	tw7 := twiddle[7]
	tw9 := twiddle[9]
	tw11 := twiddle[11]
	tw13 := twiddle[13]
	tw15 := twiddle[15]
	tw17 := twiddle[17]
	tw19 := twiddle[19]
	tw21 := twiddle[21]
	tw23 := twiddle[23]
	tw25 := twiddle[25]
	tw27 := twiddle[27]
	tw29 := twiddle[29]
	tw31 := twiddle[31]
	w1 := complex(real(tw1), -imag(tw1))
	w3 := complex(real(tw3), -imag(tw3))
	w5 := complex(real(tw5), -imag(tw5))
	w7 := complex(real(tw7), -imag(tw7))
	w9 := complex(real(tw9), -imag(tw9))
	w11 := complex(real(tw11), -imag(tw11))
	w13 := complex(real(tw13), -imag(tw13))
	w15 := complex(real(tw15), -imag(tw15))
	w17 := complex(real(tw17), -imag(tw17))
	w19 := complex(real(tw19), -imag(tw19))
	w21 := complex(real(tw21), -imag(tw21))
	w23 := complex(real(tw23), -imag(tw23))
	w25 := complex(real(tw25), -imag(tw25))
	w27 := complex(real(tw27), -imag(tw27))
	w29 := complex(real(tw29), -imag(tw29))
	w31 := complex(real(tw31), -imag(tw31))

	scale := complex(1.0/64.0, 0)
	work = work[:n]

	f0, f32 := e0+e32, e0-e32
	work[0], work[32] = f0*scale, f32*scale
	t1 = w1 * e33
	f1, f33 := e1+t1, e1-t1
	work[1], work[33] = f1*scale, f33*scale
	t2 = w2 * e34
	f2, f34 := e2+t2, e2-t2
	work[2], work[34] = f2*scale, f34*scale
	t3 = w3 * e35
	f3, f35 := e3+t3, e3-t3
	work[3], work[35] = f3*scale, f35*scale
	t4 = w4 * e36
	f4, f36 := e4+t4, e4-t4
	work[4], work[36] = f4*scale, f36*scale
	t5 = w5 * e37
	f5, f37 := e5+t5, e5-t5
	work[5], work[37] = f5*scale, f37*scale
	t6 = w6 * e38
	f6, f38 := e6+t6, e6-t6
	work[6], work[38] = f6*scale, f38*scale
	t7 = w7 * e39
	f7, f39 := e7+t7, e7-t7
	work[7], work[39] = f7*scale, f39*scale
	t8 = w8 * e40
	f8, f40 := e8+t8, e8-t8
	work[8], work[40] = f8*scale, f40*scale
	t9 = w9 * e41
	f9, f41 := e9+t9, e9-t9
	work[9], work[41] = f9*scale, f41*scale
	t10 = w10 * e42
	f10, f42 := e10+t10, e10-t10
	work[10], work[42] = f10*scale, f42*scale
	t11 = w11 * e43
	f11, f43 := e11+t11, e11-t11
	work[11], work[43] = f11*scale, f43*scale
	t12 = w12 * e44
	f12, f44 := e12+t12, e12-t12
	work[12], work[44] = f12*scale, f44*scale
	t13 = w13 * e45
	f13, f45 := e13+t13, e13-t13
	work[13], work[45] = f13*scale, f45*scale
	t14 = w14 * e46
	f14, f46 := e14+t14, e14-t14
	work[14], work[46] = f14*scale, f46*scale
	t15 = w15 * e47
	f15, f47 := e15+t15, e15-t15
	work[15], work[47] = f15*scale, f47*scale
	t16 := w16 * e48
	f16, f48 := e16+t16, e16-t16
	work[16], work[48] = f16*scale, f48*scale
	t17 = w17 * e49
	f17, f49 := e17+t17, e17-t17
	work[17], work[49] = f17*scale, f49*scale
	t18 = w18 * e50
	f18, f50 := e18+t18, e18-t18
	work[18], work[50] = f18*scale, f50*scale
	t19 = w19 * e51
	f19, f51 := e19+t19, e19-t19
	work[19], work[51] = f19*scale, f51*scale
	t20 = w20 * e52
	f20, f52 := e20+t20, e20-t20
	work[20], work[52] = f20*scale, f52*scale
	t21 = w21 * e53
	f21, f53 := e21+t21, e21-t21
	work[21], work[53] = f21*scale, f53*scale
	t22 = w22 * e54
	f22, f54 := e22+t22, e22-t22
	work[22], work[54] = f22*scale, f54*scale
	t23 = w23 * e55
	f23, f55 := e23+t23, e23-t23
	work[23], work[55] = f23*scale, f55*scale
	t24 := w24 * e56
	f24, f56 := e24+t24, e24-t24
	work[24], work[56] = f24*scale, f56*scale
	t25 = w25 * e57
	f25, f57 := e25+t25, e25-t25
	work[25], work[57] = f25*scale, f57*scale
	t26 = w26 * e58
	f26, f58 := e26+t26, e26-t26
	work[26], work[58] = f26*scale, f58*scale
	t27 = w27 * e59
	f27, f59 := e27+t27, e27-t27
	work[27], work[59] = f27*scale, f59*scale
	t28 := w28 * e60
	f28, f60 := e28+t28, e28-t28
	work[28], work[60] = f28*scale, f60*scale
	t29 = w29 * e61
	f29, f61 := e29+t29, e29-t29
	work[29], work[61] = f29*scale, f61*scale
	t30 := w30 * e62
	f30, f62 := e30+t30, e30-t30
	work[30], work[62] = f30*scale, f62*scale
	t31 := w31 * e63
	f31, f63 := e31+t31, e31-t31
	work[31], work[63] = f31*scale, f63*scale

	if !workIsDst {
		copy(dst, work)
	}

	return true
}
